---
title: Day 47 - Mastering Framer Motion
---

# Day 47 - Mastering Framer Motion

<Tabs id="day-47">

<Tab label="Preview">

<ComponentPreview name="framer-motion-day-47" />

</Tab>

<Tab label="Code">

<Files id="day-4">

<File label="index.tsx">

```tsx showLineNumbers
"use client";

import React from "react";
import EachThread from "./each-thread";
import { myImage } from "@/utils";

export default function Day47() {
  return (
    <div className="w-full max-w-2xl rounded-xl bg-gray-100 p-8">
      <EachThread image={myImage || ""} username={"Ali Reza"} />
      <EachThread image={myImage || ""} username={"Ali Reza"} />
    </div>
  );
}
```

</File>

<File label="each-thread.tsx">

```tsx showLineNumbers
import React, { type ChangeEvent, useEffect, useRef, useState } from "react";
import { motion, useAnimate } from "framer-motion";

import Image from "next/image";
import Icon from "./Icon";

interface Props {
  image: string;
  username: string;
}

export default function EachThread({ image, username }: Props) {
  const [inputField, setInputField] = useState("");
  const [files, setFiles] = useState<string[]>([]);

  const [scope, animate] = useAnimate();

  const textareaRef = useRef<null | HTMLTextAreaElement>(null);

  useEffect(() => {
    const textarea = textareaRef.current;

    if (textarea) {
      textarea.style.height = "21px";
      textarea.style.height = `${textarea.scrollHeight}px`;
    }
  }, [inputField]);

  const onChangeHandler = (event: ChangeEvent<HTMLTextAreaElement>) => {
    const { value } = event.target;

    // Check if the input consists of three or more consecutive empty lines
    if (value.match(/\n\s*\n\s*\n/)) {
      // If it does, don't update the state
      return;
    }

    setInputField(event.target.value);
  };

  const onAddingFilesHandler = async (event: ChangeEvent<HTMLInputElement>) => {
    await animate([[scope.current, { opacity: 0 }, { duration: 0.1 }]]);
    setFiles((prevFiles) => [
      ...prevFiles,
      // @ts-ignore
      ...Array.from(event.target.files).map((file) =>
        URL.createObjectURL(file)
      ),
    ]);
    await animate([
      [scope.current, { opacity: 1 }, { duration: 0.1, delay: 0.2 }],
    ]);
  };

  const onDeleteHandler = async (value: string) => {
    const values = [...files];

    const index = values.indexOf(value);

    if (index !== -1) {
      await animate([[scope.current, { opacity: 0 }, { duration: 0.1 }]]);

      values.splice(index, 1);

      setFiles(values);

      await animate([
        [scope.current, { opacity: 1 }, { duration: 0.1, delay: 0.2 }],
      ]);
    }
  };

  return (
    <div className="flex gap-4 px-4 pb-2">
      {/* User image */}
      <div className="fixed-size flex w-9 flex-col items-center gap-2 pt-1">
        <Image
          src={image}
          width={36}
          height={36}
          alt=""
          className="h-9 w-9 rounded-full object-cover"
        />
        <div className="h-full w-0.5 bg-[#e5e5e5]"></div>
      </div>
      {/* Content */}
      <div className="grow">
        <h3 className="text-[15px] font-medium">{username}</h3>
        <textarea
          ref={textareaRef}
          value={inputField}
          onChange={onChangeHandler}
          placeholder="Start a thread..."
          className="h-[21px] w-full resize-none overflow-hidden bg-transparent text-[15px] font-light outline-none"
        ></textarea>
        {files && (
          <div
            ref={scope}
            className={`flex w-full gap-1 ${files.length >= 3 ? "overflow-auto" : ""}`}
          >
            {files.map((url) => (
              <motion.div
                key={url}
                initial={{ opacity: 0 }}
                animate={{ opacity: 1 }}
                transition={{ duration: 0.2, delay: 0.1 }}
                className={`relative ${files.length >= 3 ? "fixed-size" : ""}`}
              >
                <button
                  className="button-shrink absolute right-2 top-2 flex h-[26px] w-[26px] items-center justify-center rounded-full bg-[#00000066] text-white"
                  onClick={() => onDeleteHandler(url)}
                >
                  <Icon name="close-thin" className="w-[10px]" />
                </button>
                <Image
                  src={url}
                  width={400}
                  height={400}
                  alt=""
                  className={`h-full w-full rounded-lg object-cover ${files.length >= 3 ? "max-h-[227px]" : files.length === 2 ? "max-h-[255px]" : ""}`}
                />
              </motion.div>
            ))}
          </div>
        )}
        <div className="-ml-[6px] flex">
          <label className="text-icon-muted flex w-auto min-w-9 cursor-pointer items-center justify-center gap-1 p-2 text-[15px] duration-100 active:scale-95">
            <Icon name="gallery" className="w-5" /> {files.length > 0 && "Add"}
            <input
              type="file"
              multiple
              accept="image/*"
              className="hidden"
              onChange={onAddingFilesHandler}
            />
          </label>
        </div>
      </div>
    </div>
  );
}
```

</File>

<File label="icon.tsx">

```tsx showLineNumbers
import React, { type HTMLAttributes } from "react";

type Props = {
  name: "gallery" | "close-thin";
} & HTMLAttributes<HTMLOrSVGElement>;

export default function Icon({ name, ...props }: Props) {
  const icon = {
    gallery: (
      <svg
        viewBox="0 0 22 22"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        {...props}
      >
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M0.619259 9.33809C0.268509 6.84238 0.0931388 5.59453 0.444869 4.57303C0.754259 3.6745 1.34016 2.89698 2.11861 2.3519C3.00358 1.73224 4.25144 1.55686 6.74715 1.20611L9.32189 0.844264C11.8176 0.493519 13.0654 0.318144 14.0869 0.669873C14.9854 0.979264 15.763 1.56516 16.308 2.34361C16.5343 2.66673 16.7013 3.03824 16.8393 3.5012C16.3648 3.4883 15.8369 3.48411 15.2441 3.48274C15.1947 3.38329 15.1403 3.291 15.0793 3.20397C14.7159 2.68501 14.1976 2.29441 13.5986 2.08815C12.9176 1.85366 12.0857 1.97058 10.4219 2.20441L6.06467 2.81677C4.40086 3.0506 3.56896 3.16752 2.97897 3.58063C2.46001 3.94401 2.06941 4.46236 1.86315 5.06138C1.62866 5.74238 1.74558 6.57428 1.97941 8.23809L2.59177 12.5953C2.77307 13.8853 2.88408 14.6752 3.11734 15.24C3.11802 16.1573 3.12228 16.9271 3.1492 17.587C2.7561 17.2983 2.41012 16.9458 2.1269 16.5413C1.50724 15.6564 1.33186 14.4085 0.981109 11.9128L0.619259 9.33809Z"
          fill="currentColor"
        />
        <g mask="url(#mask0_10755_8401)">
          <path
            d="M17.1172 5.7316H9.11719C7.04612 5.7316 5.36719 7.41053 5.36719 9.4816V17.4816C5.36719 19.5527 7.04612 21.2316 9.11719 21.2316H17.1172C19.1883 21.2316 20.8672 19.5527 20.8672 17.4816V9.4816C20.8672 7.41053 19.1883 5.7316 17.1172 5.7316Z"
            stroke="currentColor"
            strokeWidth="1.5"
          />
          <path
            d="M5.27148 17.7316L7.20731 15.7958C7.77518 15.2279 8.68958 15.208 9.28158 15.7507L11.1231 17.4388C11.5178 17.8006 12.1274 17.7873 12.506 17.4087L16.435 13.4798C17.0207 12.894 17.9705 12.894 18.5563 13.4797L20.6832 15.6066"
            stroke="currentColor"
            strokeWidth="1.5"
            strokeLinejoin="round"
          />
          <path
            d="M9.36719 10.9816C10.0575 10.9816 10.6172 10.422 10.6172 9.7316C10.6172 9.04124 10.0575 8.4816 9.36719 8.4816C8.67683 8.4816 8.11719 9.04124 8.11719 9.7316C8.11719 10.422 8.67683 10.9816 9.36719 10.9816Z"
            fill="currentColor"
          />
        </g>
      </svg>
    ),
    "close-thin": (
      <svg
        viewBox="0 0 29 29"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        {...props}
      >
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M26.2527 0.646371C26.8385 0.0605846 27.7882 0.0605846 28.374 0.646371C28.9598 1.23216 28.9598 2.18191 28.374 2.76769L16.593 14.5487L28.3791 26.3347C28.9649 26.9205 28.9649 27.8702 28.3791 28.456C27.7933 29.0418 26.8436 29.0418 26.2578 28.456L14.4717 16.67L2.68566 28.456C2.09987 29.0418 1.15013 29.0418 0.56434 28.456C-0.0214467 27.8702 -0.0214467 26.9205 0.56434 26.3347L12.3504 14.5487L0.56942 2.76769C-0.0163665 2.18191 -0.0163665 1.23216 0.56942 0.646371C1.15521 0.0605846 2.10495 0.0605846 2.69074 0.646371L14.4717 12.4273L26.2527 0.646371Z"
          fill="currentColor"
        />
      </svg>
    ),
  }[name];

  return icon;
}
```

</File>

</Files>

</Tab>

</Tabs>